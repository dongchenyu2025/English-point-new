<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>单词发音功能测试页面</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 40px auto;
            padding: 0 20px;
            background-color: #f9f9f9;
        }
        h1, h2 {
            color: #1a1a1a;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .container {
            background-color: #fff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .word {
            cursor: pointer;
            font-weight: bold;
            color: #007bff;
            text-decoration: none;
            border-bottom: 2px dotted #007bff;
            transition: color 0.2s, background-color 0.2s;
        }
        .word:hover {
            background-color: #e7f3ff;
            color: #0056b3;
        }
        .controls {
            margin-top: 20px;
            padding: 15px;
            background-color: #f1f1f1;
            border-radius: 5px;
        }
        .controls label {
            margin-right: 15px;
            font-weight: bold;
        }
        .controls button, .controls select {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
        }
        .controls button.active {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>英语点读发音测试</h1>
        <p>这是一个使用浏览器内置语音合成功能（Web Speech API）的演示。请点击下面的蓝色单词来测试发音效果。</p>

        <div class="controls">
            <label>口音选择:</label>
            <button id="btn-us" class="active" onclick="setAccent('en-US')">美式发音 (en-US)</button>
            <button id="btn-gb" onclick="setAccent('en-GB')">英式发音 (en-GB)</button>
            
            <br><br>

            <label for="rate">语速调节:</label>
            <input type="range" id="rate" min="0.5" max="2" value="1" step="0.1">
            <span id="rate-value">1.0</span>
        </div>
        
        <h2>场景：日常对话</h2>
        <p>
            <span class="word" onclick="speak('Hello')">Hello</span>, how are you today? 
            I am learning <span class="word" onclick="speak('JavaScript')">JavaScript</span> to build a 
            <span class="word" onclick="speak('website')">website</span>. It's an 
            <span class="word" onclick="speak('interesting')">interesting</span> but 
            <span class="word" onclick="speak('challenging')">challenging</span> journey.
        </p>

        <h2>场景：科技词汇</h2>
        <p>
            We need to <span class="word" onclick="speak('integrate')">integrate</span> a new 
            <span class="word" onclick="speak('authentication')">authentication</span> API into our 
            <span class="word" onclick="speak('application')">application</span>. The 
            <span class="word" onclick="speak('database')">database</span> performance needs 
            <span class="word" onclick="speak('optimization')">optimization</span>. Let's discuss the
            <span class="word" onclick="speak('architecture')">architecture</span> tomorrow.
        </p>
        
        <h2>场景：容易读错的单词</h2>
        <p>
            Please pay attention to the pronunciation of 
            <span class="word" onclick="speak('schedule')">schedule</span>, 
            <span class="word" onclick="speak('Wednesday')">Wednesday</span>, 
            and <span class="word" onclick="speak('colonel')">colonel</span>. The 
            <span class="word" onclick="speak('receipt')">receipt</span> is on the table.
        </p>
    </div>

    <script>
        // 全局变量，用于存储当前选择的口音和语速
        let currentAccent = 'en-US';
        let currentRate = 1.0;

        // 获取语音合成实例
        const synth = window.speechSynthesis;

        // 绑定语速滑块的事件
        const rateInput = document.getElementById('rate');
        const rateValueSpan = document.getElementById('rate-value');
        
        rateInput.addEventListener('input', () => {
            currentRate = parseFloat(rateInput.value);
            rateValueSpan.textContent = currentRate.toFixed(1);
        });

        // 设置口音的函数
        function setAccent(accent) {
            currentAccent = accent;
            // 更新按钮的激活状态
            document.getElementById('btn-us').classList.toggle('active', accent === 'en-US');
            document.getElementById('btn-gb').classList.toggle('active', accent === 'en-GB');
        }

        // 核心发音函数
        function speak(word) {
            // 确保之前的发音已经停止，避免快速点击时发音重叠
            if (synth.speaking) {
                synth.cancel();
            }

            // 检查浏览器是否支持语音合成
            if (synth) {
                const utterance = new SpeechSynthesisUtterance(word);
                
                // 设置属性
                utterance.lang = currentAccent;
                utterance.rate = currentRate;

                // [可选] 寻找特定口音的声音
                // 注意：这在不同浏览器和操作系统上表现不同
                const voices = synth.getVoices();
                let selectedVoice = voices.find(voice => voice.lang === currentAccent);
                
                // 如果找到了匹配的声音，则使用它
                if(selectedVoice){
                    utterance.voice = selectedVoice;
                }
                
                // 朗读
                synth.speak(utterance);

            } else {
                alert('抱歉，您的浏览器不支持语音合成功能。请尝试使用最新版本的 Chrome 或 Edge 浏览器。');
            }
        }
        
        // 第一次加载时，getVoices() 可能返回空列表，需要监听 voiceschanged 事件
        // 这样可以确保在切换口音时能找到对应的 voice
        synth.onvoiceschanged = () => {
          console.log("可用语音列表已更新:", synth.getVoices());
        };

    </script>

</body>
</html>